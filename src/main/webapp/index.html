<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title>Dark Souls death counter</title>
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
    <link rel="icon" type="image/ico" href="/favicon.ico" />
</head>
<body>
<div class="preload-images">
    <img src="/images/background-about.png" alt="Preloading images...">
    <img src="/images/background-faq.png" alt="Preloading images...">
    <img src="/images/background-home.png" alt="Preloading images...">
    <img src="/images/background-results.png" alt="Preloading images...">
    <img src="/images/background-stats.png" alt="Preloading images...">
</div>
<div id="wrapper" class="nav-home">
    <div class="content-left">
        <div class="navbar">
            <span class="navbar-bullet-start">&bull;</span>
            <div id="navHome" class="navlink" onclick="navigate('home')"><a>HOME</a></div>
            <span class="navbar-bullet">&bull;</span>
            <div id="navStats" class="navlink" onclick="navigate('stats')"><a>STATS</a></div>
            <span class="navbar-bullet">&bull;</span>
            <div id="navAbout" class="navlink" onclick="navigate('about')"><a>ABOUT</a></div>
            <span class="navbar-bullet">&bull;</span>
            <div id="navFaq" class="navlink" onclick="navigate('faq')"><a>FAQ</a></div>
            <span class="navbar-bullet-end">&bull;</span>
            <div class="divider-line">
            </div>
        </div>
        <div id="contentBody">
            <div id="contentHome">
                <div class="description-top">
                    <span class="uppercase">WELCOME TO DARK SOULS DEATHS!</span><br>
                    Upload a save file from Dark Souls to see how many times you have died.
                </div>
                <div class="file-uploader">
                    <input disabled type="text" id="fileName" name="fileName" value="No file selected."><br>
                    <form id="saveFile" method="POST" action="cgi-bin/results.py" enctype="multipart/form-data">
                        <input type="file" name="file" id="file" class="inputfile" onchange="updateFileName(this)"/>
                        <label for="file">BROWSE</label>
                        <input type="submit" id="submit" value="UPLOAD" onclick="submitFile(); return false;">
                    </form>
                </div>
                <img class="spinner" src="/images/spinner.gif" alt="Uploading..."/>
                <div class="description-bottom">
                    The PC version's save files can be found in <b>Documents/NBGI/DarkSouls/[Your name]</b>. If you have an idea on how to make this work for consoles, <a href="/about.html#contact">let us know</a>.
                </div>
            </div>
            <div id="contentFaq">
                <span class="uppercase">FREQUENTLY ASKED QUESTIONS
                <br><br>
                Q: MY DEATH COUNT IS REALLY HIGH/LOW! I TOTALLY SUCK/RULE AT THIS GAME!<br>
                A: </span>That's not actually a question, but it seems to be the #1 misconception among our visitors. Please don't read too much meaning into people's death counts&mdash;this game was never meant to discourage dying! Some players are cautious, some are bold, and some are kamikaze lemmings, but all of them have a valid playstyle. (Except the ones who hack for PvP. Fuck you people.)
                <br><br>
                <span class="uppercase">Q: MY DEATH COUNT SEEMS OFF. WHAT GIVES?<br>
                A: </span>So far as we know, this does not count the times you died as a phantom. The details are a little fuzzy on how this works.
                <br><br>
                <span class="uppercase">Q: ARE YOU GOING TO SUPPORT DARK SOULS II?<br>
                A: </span>We hope so! A whole lot of things have to happen first, though:<br>
                The game gets released for PC (April 25th)<br>
                We play the game (April 25th until May sometime at least. We aren't speedrunners.)<br>
                We crack open a save file and find the death counter variable, assuming it exists.<br>
                We write a whole bunch of code in our free time, between jobs/games/life. Patience!
                <br><br>
                <span class="uppercase">Q: ARE YOU GOING TO SUPPORT CONSOLES?<br>
                A: </span>Possibly, if saves work the same way. Please send us your console save files for testing if you have them! Note that, whatever we come up with, you'll still be on your own for getting the file out of your console and onto the site.
                <br><br>
                <span class="uppercase">Q: I GOT A PYTHON ERROR/"DID NOT INPUT A VALID FILE". WHAT'S WRONG?<br>
                A: </span>Not sure, but we're working on it. The best thing you can do to help is send us your save file and tell us as much as you can about your version of the game&mdash;Where did you get it from? What language is it in? Is it pirated/hacked/haunted by malevolent spirits? What are the names of all your characters?
            </div>
            <div id="contentAbout">
                <span class="uppercase">ABOUT US
                <br><br>
                VERET</span> is the frontend developer and co-founder of <b>Dark Souls Deaths</b>. When he heard there was a death counter variable in every save game, he was inspired to make a user-friendly way for players to see their death counts and compare stats.  He also has a bit of a thing for <a href="http://imgur.com/a/G3gil">graphs</a>.
                <br>
                <span class="uppercase">FACETANK</span> is the backend developer and shorter, beardier co-founder of <b>Dark Souls Deaths</b>. He designed the DB and wrote Python in order to glue all this together.
                <br><br>
                <span class="uppercase">CONTRIBUTORS
                <br><br>
                EUR0PA</span> first discovered how to extract a player's death count from their save file, using what we can only assume is black magic.  You can still run the <a href="https://gist.github.com/infausto/8382836">original Python script</a> (requires Python 2.7) if this site isn't working for you.
                <br>
                <span class="uppercase">DARKDEUS</span> is responsible for the beautiful background screenshots on every page.  You can view the full gallery <a href="http://www.flickr.com/photos/15539352@N02/sets/72157634774669900/">on flickr.</a>
                <br><br>
                <span class="uppercase">CONTACT</span>
                <br><br>
                Site questions and feedback<br>
                <a href="mailto:admin@darksoulsdeaths.com">admin@darksoulsdeaths.com</a><br>
                Technical support<br>
                <a href="mailto:admin@darksoulsdeaths.com">admin@darksoulsdeaths.com</a><br>
                Legal inquiries<br>
                <a href="mailto:admin@darksoulsdeaths.com">admin@darksoulsdeaths.com</a><br>
                Hate mail<br>
                <a href="mailto:admin@darksoulsdeaths.com">support@gfwl.microsoft.com</a>
            </div>
            <div id="contentStats">
                <div id="chartADPP"></div>
                <div id="chartDeaths"></div>
                <div id="chartPlaythrough"></div>
                <div id="chartProgress"></div>
                <div id="chartOptional"></div>
                <div id="chartSmornstein"></div>
            </div>
        </div>
        <div class="copyright-notice">
            <div class="divider-line">
            </div>
            <div class="disclaimer">
                Dark Souls is &copy; NAMCO BANDAI Games Inc. and FromSoftware, Inc.  This site is in no way affiliated with or endorsed by either company.
            </div>
        </div>
    </div>
<!--    <div class="content-right">
        <div class="you-died">
        </div>
    </div>-->
</div>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="/scripts/charts.js"></script>
<script type="text/javascript">
    // Load the Visualization API and the piechart package.
    google.load('visualization', '1.0', {'packages':['corechart']});

    // Set a callback to run when the Google Visualization API is loaded.
    //TODO: would it be better to load chart data and GV simultaneously, then render when both are done?
    google.setOnLoadCallback(loadChartData);
</script>
<script type="text/javascript">
    function navigate(page)
    {
        let wrapper = document.getElementById('wrapper');

        for(let i=0; i<wrapper.classList.length; i++)
        {
            if(wrapper.classList[i].indexOf('nav-') === 0)
            {
                wrapper.classList.remove(wrapper.classList[i]);
            }
        }

        if(page === 'home')
        {
            wrapper.classList.add('nav-home');
        }
        else if(page === 'stats')
        {
            wrapper.classList.add('nav-stats');
        }
        else if(page === 'about')
        {
            wrapper.classList.add('nav-about');
        }
        else if(page === 'faq')
        {
            wrapper.classList.add('nav-faq');
        }
        else if(page === 'results')
        {
            wrapper.classList.add('nav-results');
        }
        else
        {
            console.error('Page name "' + page + '" not found!');
        }
    }
    function updateFileName(fileInput)
    {
        let displayField = document.getElementById('fileName');
        let fname = fileInput.value;

        if(fname === '')
        {
            displayField.value = 'No file selected.';
            return;
        }

        //remove "C:\fakepath\"
        fname = fname.split('\\');
        fname = fname[fname.length-1];

        displayField.value = fname;
    }
    function submitFile()
    {
        showLoadingGif();
        let file = document.getElementById('file').files[0];
        let formData = new FormData();
        formData.append('fileData', file);
        fetch('request/processfile', {method:'POST', body:formData})
            .then(response => response.json())
            .then(data =>
            {
                console.log(data); //TODO
                hideLoadingGif();
            });
    }
    function showLoadingGif()
    {
        document.getElementsByClassName('spinner')[0].style.display = 'block';
        document.getElementsByClassName('file-uploader')[0].style.display = 'none';
    }
    function hideLoadingGif()
    {
        document.getElementsByClassName('spinner')[0].style.display = 'none';
        document.getElementsByClassName('file-uploader')[0].style.display = 'block';
    }
</script>
</body>
</html>